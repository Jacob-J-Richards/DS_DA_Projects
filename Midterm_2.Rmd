---
title: "Untitled"
output: html_document
date: "2024-11-10"
---

# Module 7

-   Data points (x,y) are naturally paired samples as x and y come from the same observation

## Pearson Correlation Coefficient

### Proc corr - options

will produce matrix of pearson corr coef's with pvalue directly beneath it, all var variables will be the rows and columns so the main diagonal will be all 1's.

```{r,eval=FALSE}
PROC CORR DATA= fitness NOSIMPLE;  #change to PROC CORR DATA= fitness NOSIMPLE; to only get corr coef and p-value or replace "NOSIMPLE" with RANK
    VAR Oxygen_Consumption Runtime; #2x2 matrix produced by only var variables inputted
RUN;
```

### Proc corr - correlation coeffient matrix

will produce matrix of cooraltion coeficients, rows = with, columns = vards, with output in order of rank corr coef largest to least

```{r,eval=FALSE}
PROC CORR DATA= fitness RANK;
  VAR Runtime Age Weight Run_Pulse Rest_Pulse Maximum_Pulse Performance; # 1x7 corr coef matrix will also print simple statistics
  WITH Oxygen_Consumption;
RUN;

PROC CORR DATA= fitness NOSIMPLE;
  VAR Runtime Age Weight Run_Pulse Rest_Pulse Maximum_Pulse Performance; # 7x7 corr coef matrix, no statistics, only corr coef and p-values 
RUN;
```

### Pearson product-moment and Spearman rank-order correlation

```{r,eval=FALSE}
DATA spearcc;
  INPUT X Y XRank YRank;
  DATALINES;
   1  1  1 1
   3  2  2 2
   7  3  3 3
   9  6  4 4
  11  8  5 5
;
RUN;
PROC CORR DATA=spearcc 
PEARSON /*Requests Pearson product-moment correlation  */
SPEARMAN /*Requests Spearman rank-order correlation */    NOSIMPLE 
NOPROB /*Suppresses p-values */; 
RUN;
```

### partial cooralation option

```{r,eval=FALSE}
PROC CORR DATA=fitness;
  VAR Oxygen_Consumption Runtime Run_Pulse Rest_Pulse Maximum_Pulse Age Weight; 
  PARTIAL Performance; #*The PARTIAL statement lists variables to use in the calculation of partial correlation statistics.*/
RUN;        
```

output: the p-values are testing H0: population corr coef = 0

```{r,eval=FALSE}
Pearson Correlation Coefficients, N = 31
                        Prob > |r| under H0: Rho=0
Oxygen_Consumption   Performance        Runtime      Rest_Pulse
                         0.86377       -0.86219        -0.39935

         PVALUE          <.0001         <.0001          0.0260

Oxygen_Consumption     Run_Pulse          Age     Maximum_Pulse
                        -0.39808       -0.31162        -0.23677
        PVALUE           0.0266         0.0879          0.1997

Oxygen_Consumption        Weight
                        -0.16289
            PVALUE       0.3813

```

```{r,eval=FALSE}
± 1.00 	Perfect Correlation
± 0.80 	Strong Correlation
± 0.50 	Moderate Correlation
± 0.20 	Weak Correlation
± 0.00 	No Correlation
```

### R-square - aka coef of determination

is just the (pearson correlation coef)\^2 variables corresponding to signifigant R\^2 p-values have a significant linear correlation between each other.


## Regression 

### conditions of regression analysis validity

assumptions for regression model 
```{r,eval=FALSE}
The errors have a mean of 0 at each value of the independent variable.
The errors have the same variance at each value of the independent variable.
The errors are independent.
The errors are normally distributed (for confidence intervals and tests).
```

Plots to verify assumptions:
Residuals vs. Predicted (predicted responce variable by the model)
Residuals vs. (Observed Values of the Independent Variable, used to produce model)
Studentized Residuals vs. (Observed Values of the Independent Variable) (OBS)
Residual by QQ plot

```{r,eval=FALSE}
GOPTIONS RESET=ALL;
PROC REG DATA= fitness;
MODEL Oxygen_Consumption=Performance;
 PLOT R.*(P. Performance); #R. will plot residual for *(P. Performance) [the P. is response estimate from the model, and Performance is actual predictor variable]
PLOT STUDENT.*OBS. / #(STUDENT. will divide residuals by standard errors and *OBS. is what it will be plotted by as number of observations
VREF=3 2 -2 -3 #refrence lines for studentized residuals
VAXIS=-4 TO 4 BY 1 #upper and lower bounds of studnized residual plot 
HAXIS=0 TO 32 BY 1; # left and right bounds of the studentized residual plot 
PLOT RESIDUAL.* NQQ.; # residual by qq plot 
SYMBOL V=DOT;
TITLE "Plots Of Diagnostic Statistics";
RUN;
QUIT;
```

Plot of residuals vs. predicted values of Oxygen_Consumption (dependent variable)

-   randomly scattered about the reference line at 0
-   no apparent trends or patterns
-   check

Plot of residuals vs. observed values of Performance (independent variable)

Since residuals scatter around 0, we can verify the assumption:

-   Have a mean of 0 at each value of the independent variable.
-   Because of no apparent trends or patterns in the residuals, we can verify the assumption:
-   Have the same variance at each value of the independent variable.
-   check

Studentized Residuals vs. actual predictor values given to produce regression line

-   produce studentship residuals vs observation number
-   no unusually large residuals -\> check
-   produce residuals vs normal quantiles
-   straight qq line --\> normal -\> check


### Proc Reg - with fitted model 
don't forget to check the signifgance levels of intercept and coef of regression model
```{r,eval=FALSE}
GOPTIONS RESET=ALL FTEXT='ARIAL/BO' GUNIT=PCT HTEXT=3;
#The PROC REG statement is used when you want to fit a model to the data, you must also use a MODEL statement;
PROC REG DATA=fitness;  
  MODEL Oxygen_Consumption = Performance/ CLB ALPHA=0.01;
#MODEL dependent variable(s)= independent-variables/ options;
#CLB: computes 100(1-a) % confidence limits for the parameter estimates;
#ALPHA= option sets significance value for confidence and prediction intervals and tests;
  PLOT Oxygen_Consumption*Performance;
#The PLOT statement in PROC REG displays scatter plots with y variable on the vertical axis, x variable on the horizontal axis, and the regression line;
  SYMBOL V=DOT H=1.5 CV=RED W=2 CI=BLACK ;
RUN;
QUIT;
```

### Proc Reg - Need Predictions with confidence interval

```{r,eval=FALSE}
proc import datafile="/home/u63989204/Module 7/Module 7 Labs/muscle.txt"
dbms=dlm
out = work.muscle_and_age replace;
getnames=yes;
option validvarname=v7;
run;

proc contents data=work.muscle_and_age;
run;

data muscle;
set work.muscle_and_age;
run;

DATA NEEDEDPREDICTIONS;
INPUT AGE @@;
DATALINES;
66 40
;

RUN;
DATA PREDICT;
SET MUSCLE NEEDEDPREDICTIONS;
RUN;
PROC REG DATA=PREDICT;
MODEL MASS=AGE / P CLM ALPHA=0.02;
RUN;
```

### Proc Reg - compairing goodness of fit for transformed variable linear model 

```{r,eval=FALSE}
data dose_response;
input dose systolic diastolic;
log_dose = LOG(dose);
datalines;
4 180 110
4 190 108
4 178 100
8 170 100
8 180 98
8 168 88
16 160 80
16 172 86
16 170 86
32 140 80
32 130 72
32 128 70
;

PROC REG DATA = dose_response;
    MODEL systolic = log_dose;
    plot systolic*log_dose;
    MODEL diastolic = log_dose;
    plot diastolic*log_dose;
RUN;

PROC REG DATA=dose_response;
   MODEL systolic = log_dose;  #replace with MODEL systolic = log_dose / NOPRINT; if only want the plot
   PLOT RESIDUAL.*log_dose; 
   MODEL diastolic = log_dose;
   PLOT RESIDUAL.*log_dose; 
RUN;
```
in examination of the adjusted r-square, the non transformed predictor variable was better for Systolic blood pressure 
and the natural logarithim LOG() was better for Diastolic blood pressure 


# Module 9 




