---
title: "Untitled"
output: html_document
date: "2024-11-19"
---

```{r}
setwd("/Users/jacobrichards/Desktop/DS_DA_Projects/Renewal_Response")
#setwd("C:/Users/jake pc/Desktop/DS_DA_Projects/Renewal_Response")
data <- read.csv(file="lease_renewal.csv",header=TRUE)
data
```

Important Note: Please do not build any kind of regression or classification model to address the questions below

What are the key drivers that explain whether a resident will renew the lease or not? In other words, what are the renewal promoters and detractors?

First lets divide the data set into tenants that renewed and those that did not.

```{r}
#rows that did renew 
RENEW <- data[data[,18] == 1, ]

#rows that did not renew 
NOT_RENEW <- data[data[,18] == 0, ]

#rent increase less than 10 
RENT_INCREASE_LT_TEN <- data[data[,2] == 0 & data[,3] == 0 & data[,4] == 0,]

#rent increased 10 percent 
RENT_INCREASE_10 <- data[data[,3] == 1,]

#rent increased 20 percent 
RENT_INCREASE_20 <- data[data[,4] == 1,]

#there was no rent change at all 
NO_RENT_INCREASE <- data[data[,2] == 1,]

RR <- matrix(nrow=2,ncol=2)

RR[1,1] <- length(intersect(row.names(RENT_INCREASE),row.names(NOT_RENEW)))

RR[1,2] <- length(intersect(row.names(RENT_INCREASE),row.names(RENEW)))

RR[2,1] <- length(intersect(row.names(NO_RENT_INCREASE),row.names(NOT_RENEW)))

RR[2,2] <- length(intersect(row.names(NO_RENT_INCREASE),row.names(RENEW)))
```


```{r}
#expose this time will be lease length's
RR_lease_length <- matrix(nrow=2,ncol=2)

FIRST_LEASE <- data[data[,7]==1,]

FIRST_LEASE

#RR_lease_length[1,1] <- length(intersect(row.names(FIRST_LEASE),row.names(NOT_RENEW)))

#RR_lease_length[2,1] <- length(intersect(row.names(NO_RENT_INCREASE),row.names(NOT_RENEW)))

```

| Cohort_study (Risk,Ratio) | NOT_RENEW | RENEW |
|---------------------------|-----------|-------|
| RENT_INCREASE             | 51797     | 10372 |
| NO_RENT_INCREASE          | 12411     | 5270  |

X\
The number of NOT_RENEW among RENT_INCREASE.

Y\
The number of NOT_RENEW among NO_RENT_INCREASE.

m1\
The number of individuals in RENT_INCREASE..

m2\
The number of individuals in NO_RENT_INCREASE.

```{r}
library(fmsb)

RR[1,1] <- length(intersect(row.names(RENT_INCREASE),row.names(NOT_RENEW)))

RR[1,2] <- length(intersect(row.names(NO_RENT_INCREASE),row.names(NOT_RENEW)))

riskratio(RR[1,1], RR[1,2], nrow(RENT_INCREASE), nrow(NO_RENT_INCREASE), conf.level=0.95, p.calc.by.independence=TRUE) 
```

with 95% confidence the odds ratio was between 1.174866 and 1.199149. Given that your rent increased, the probability that you did not renew your lease was between 1.174866 and 1.199149 times greater than if your rent had not increased 95% of the time.

This was calculated for when there is any rent change at all including less than 10%, 10% and 20%. What if we isolated and test for the risk ratio of rent increasing by 10 or 20% compaired to not at all instead of the aggregate.

```{r}
RR[1,1] <- length(intersect(row.names(RENT_INCREASE_10),row.names(NOT_RENEW)))

RR[1,2] <- length(intersect(row.names(NO_RENT_INCREASE),row.names(NOT_RENEW)))

riskratio(RR[1,1], RR[1,2], nrow(RENT_INCREASE_10), nrow(NO_RENT_INCREASE), conf.level=0.95, p.calc.by.independence=TRUE) 
```
Usage
 riskratio(X, Y, m1, m2, conf.level=0.95, p.calc.by.independence=TRUE) 
Arguments
X	
The number of disease occurence among exposed cohort.

Y	
The number of disease occurence among non-exposed cohort.

m1	
The number of individuals in exposed cohort group.

m2	
The number of individuals in non-exposed cohort group.

conf.level	
Probability for confidence intervals. Default is 0.95.

```{r}
RR[1,1] <- length(intersect(row.names(RENT_INCREASE_20),row.names(NOT_RENEW)))

RR[1,2] <- length(intersect(row.names(NO_RENT_INCREASE),row.names(NOT_RENEW)))

riskratio(RR[1,1], RR[1,2], nrow(RENT_INCREASE_20), nrow(NO_RENT_INCREASE), conf.level=0.95, p.calc.by.independence=TRUE) 
```

for the rent increasing specifically to 20 percent the risk ratio was 1.2 

let's look at lease length 
```{r}

```
